<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Paramètres du compte à rebours</title>
  <style>
    body {
	    font-family: Arial, sans-serif;
	    background-color: #fff;
	    color: #000;
	    display: flex;
	    flex-direction: column;
	    align-items: center;
	    justify-content: center;
	    min-height: 100vh;
	    margin: 0;
	    padding: 20px;
	    }
    
    h1 {
	    margin-bottom: 20px;
	    }
    
    form {
	    display: flex;
	    flex-direction: column;
	    gap: 10px;
	    background: #f8f8f8;
	    padding: 20px;
	    border-radius: 12px;
	    width: 100%;
	    max-width: 500px;
	    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
	    }
    
    label {
	    font-weight: bold;
	    }
    
    input, textarea, button {
	    padding: 10px;
	    font-size: 1rem;
	    border: 1px solid #ccc;
	    border-radius: 6px;
	    }
    
    button {
	    background-color: #007BFF;
	    color: white;
	    cursor: pointer;
	    transition: background 0.2s;
	    }
    
    button:hover {
	    background-color: #0056b3;
	    }
    
    #preview {
	    margin-top: 30px;
	    text-align: center;
	    }
    
    #preview img {
	    border: 2px solid #ccc;
	    border-radius: 10px;
	    max-width: 100%;
	    }
  </style>
</head>
<body>

  <h1>Modifier le design du compte à rebours</h1>

  <form method="POST" oninput="updatePreview()">
    <label for="target_date">Date cible :</label>
    <input type="datetime-local" id="target_date" name="target_date"
		    value="{{ config['target_date'] | replace(' ', 'T')[:19] }}" required>

    <label for="background_color">Couleur de fond :</label>
    <input type="color" id="background_color" name="background_color"
		    value="{{ config['background_color'] }}">

    <label for="text_color">Couleur du texte :</label>
    <input type="color" id="text_color" name="text_color"
		    value="{{ config['text_color'] }}">

    <label for="font_size">Taille du texte :</label>
    <input type="number" id="font_size" name="font_size"
		    value="{{ config['font_size'] }}" min="10" max="100">

    <label for="message_prefix">Préfixe du message :</label>
    <input type="text" id="message_prefix" name="message_prefix"
		    value="{{ config['message_prefix'] }}">

    <button type="submit">Valider et télécharger le GIF</button>
  </form>

  <div id="preview">
    <h2>Aperçu en direct :</h2>
    <img id="previewImg" src="/countdown.gif" alt="Aperçu du compte à rebours">
  </div>

  <script>
    function updatePreview() {
	    const bg = document.getElementById('background_color').value;
	    const txt = document.getElementById('text_color').value;
	    const size = document.getElementById('font_size').value;
	    
	    // Recharge le GIF avec un paramètre cache-buster
	    const img = document.getElementById('previewImg');
	    img.src = `/countdown.gif?cb=${Date.now()}&bg=${bg}&txt=${txt}&size=${size}`;
    }
  </script>
</body>
</html>